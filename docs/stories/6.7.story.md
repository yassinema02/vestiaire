# Story 6.7: Gamification Profile View

## Status

**Implemented**

---

## Story

**As a** user,
**I want** to a dedicated view showing all my gamification progress,
**so that** I can see my full achievement history.

---

## Acceptance Criteria

1. Gamification section on Profile tab (or specific sub-screen)
2. Shows: current level, XP progress, current streak, total points
3. Badge collection grid with earned/locked status
4. Recent activity feed (last 5 events)
5. Leaderboard placeholder (future social feature)
6. Share button to export achievements card

---

## Tasks / Subtasks

- [ ] **Task 1: Profile UI Refactor** (AC: 1, 2)
  - [ ] Update `apps/mobile/app/(tabs)/profile.tsx`.
  - [ ] Consolidate previous components into a cohesive layout:
    - Top: `LevelProgressCard` (Story 6.2)
    - Row: `StreakCard` (Story 6.3) | Total Points (Story 6.1)
    - Section: "Badges" -> `BadgeGrid` (Story 6.4)
  - [ ] Ensure smooth scrolling and responsive layout.

- [ ] **Task 2: Activity Feed** (AC: 4)
  - [ ] Create `ActivityFeed` component.
  - [ ] Fetch data from `point_history` table (limit 5, order by created_at desc).
  - [ ] Display events: "Logged outfit (+5 pts)", "Earned Badge (+50 pts)".
  - [ ] Relative time format (e.g., "2h ago").

- [ ] **Task 3: Leaderboard Placeholder** (AC: 5)
  - [ ] Create `LeaderboardTeaser` component.
  - [ ] Visual: "Leaderboard Coming Soon" or mocked "Top 3".
  - [ ] Text: "Compete with friends soon!"

- [ ] **Task 4: Share Functionality** (AC: 6)
  - [ ] Implement `Share.share()` (React Native).
  - [ ] Generate a text summary: "I'm Level 5 on Vestiaire with 250 points and a 10-day streak! #VestiaireStyle".
  - [ ] (Bonus) View-shot of the `LevelProgressCard` to share as image (optional for MVP).

- [ ] **Task 5: Testing**
  - [ ] Manual Test: Verify all sections load correct data.
  - [ ] Manual Test: Test Share button invokes native share sheet.
  - [ ] Manual Test: Check Activity Feed updates after an action (e.g., upload item).

---

## Dev Notes

### Architecture references
- **Aggregator**: This story is largely about aggregating UI components built in 6.1-6.6 into a polished view.
- **Data Source**: `user_stats` (Level, Points, Streak), `user_badges` (Badges), `point_history` (Activity).

### Technical Decisions
- **Scroll View**: The Profile screen needs to be scrollable as content grows (especially Badge Grid).
- **Activity Feed**: Direct query to `point_history` is sufficient for "My Activity".

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-07 | 1.0 | Initial story draft | Bob (SM) |
