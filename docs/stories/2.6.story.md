# Story 2.6: Item Detail View

## Status

**Done** âœ…

---

## Story

**As a** user,  
**I want** to view and edit details of a single item,  
**so that** I can update information or see item stats.

---

## Acceptance Criteria

1. Full-size image display with zoom capability
2. All metadata displayed (name, brand, category, color, price, date)
3. Edit button allows modifying any field
4. Statistics shown: wear count (placeholder for Epic 5)
5. "Delete item" option with confirmation dialog
6. "Mark as favorite" toggle
7. Swipe gestures to navigate between items

---

## Tasks / Subtasks

- [x] **Task 1: Implement full item detail screen** (AC: 1, 2)
  - [x] Replace placeholder in `app/(tabs)/item-detail.tsx`
  - [x] Fetch item data using `itemsService.getItem(id)`
  - [x] Display full-size image with zoom support (Modal-based fullscreen viewer)
  - [x] Show all metadata: name, brand, category, sub-category, colors, seasons, occasions, purchase price, purchase date

- [x] **Task 2: Display item statistics** (AC: 4)
  - [x] Create statistics section showing wear count
  - [x] Show last worn date if available
  - [x] Show date added to wardrobe

- [x] **Task 3: Implement favorite toggle** (AC: 6)
  - [x] Add favorite heart icon in header
  - [x] Use `itemsService.toggleFavorite()` on press
  - [x] Update UI state immediately (optimistic update)

- [x] **Task 4: Implement edit functionality** (AC: 3)
  - [x] Add edit button that toggles edit mode
  - [x] Make metadata fields editable (name, brand, seasons, occasions, price)
  - [x] Save changes using `itemsService.updateItem()`
  - [x] Show success/error feedback via Alert

- [x] **Task 5: Implement delete functionality** (AC: 5)
  - [x] Add delete button with trash icon
  - [x] Show confirmation alert before deleting
  - [x] Use `itemsService.deleteItem()` on confirm
  - [x] Navigate back to wardrobe after successful delete

- [x] **Task 6: Implement swipe navigation** (AC: 7)
  - [x] Pass items array from wardrobe screen via navigation params
  - [x] Implement Previous/Next buttons to navigate between items
  - [x] Show item counter (e.g., "3/10")

---

## Dev Notes

### Previous Story Insights
[Source: Story 2.5]
- Item detail screen placeholder exists at `app/(tabs)/item-detail.tsx`
- Navigation from wardrobe passes `itemId` as search param
- Screen is hidden from tab bar (defined in `app/(tabs)/_layout.tsx` with `href: null`)
- Wardrobe uses `processed_image_url` or `image_url` for display

### Data Models
[Source: architecture.md#Data Models]

```typescript
interface WardrobeItem {
    id: string;
    user_id: string;
    image_url: string;
    original_image_url?: string;
    processed_image_url?: string;
    name?: string;
    brand?: string;
    category?: string;
    sub_category?: string;
    colors?: string[];
    seasons?: string[];
    occasions?: string[];
    purchase_price?: number;
    purchase_date?: string;
    wear_count: number;
    last_worn_at?: string;
    is_favorite: boolean;
    status: 'pending' | 'processing' | 'complete';
    created_at: string;
    updated_at: string;
}
```

### Available Service Methods
[Source: services/items.ts]

- `itemsService.getItem(id)` - Fetch single item by ID
- `itemsService.updateItem(id, updates)` - Update item fields
- `itemsService.deleteItem(id)` - Delete item
- `itemsService.toggleFavorite(id, isFavorite)` - Toggle favorite status
- `itemsService.incrementWearCount(id)` - Increment wear counter

### File Locations
- Screen: `apps/mobile/app/(tabs)/item-detail.tsx`
- Services: `apps/mobile/services/items.ts` (already complete)
- Navigation: Uses `expo-router` with `useLocalSearchParams` for itemId

### UI Components Needed
- Full-screen zoomable image viewer
- Metadata display cards
- Edit mode form inputs
- Delete confirmation dialog (use `Alert.alert`)
- Favorite toggle button (heart icon)
- Statistics display section

### Color Palette Reference
[Source: services/aiCategorization.ts]
- Use `COLORS` array from aiCategorization for displaying color swatches
- 21 colors available with hex values

---

## Testing

### Manual Testing
- Verify image loads and can be zoomed
- Verify all metadata displays correctly
- Test edit mode: change values and save
- Test delete: confirm dialog appears, item removed after confirmation
- Test favorite toggle: icon updates, persists after refresh
- Test prev/next navigation between items

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-24 | 1.0 | Initial story draft | Bob (SM) |
| 2026-01-24 | 1.1 | Implementation complete | James (Dev) |

---

## Dev Agent Record

### Agent Model Used
Gemini 2.5 Pro

### Debug Log References
None - implementation completed without issues

### Completion Notes List
- Implemented full item detail screen with all 6 tasks completed
- Used Modal for fullscreen image zoom instead of external library (simpler, no extra deps)
- Navigation between items uses Previous/Next buttons with counter display
- Edit mode supports name, brand, price, seasons, and occasions
- Category display is read-only (set during AI categorization)
- All service methods from items.ts utilized correctly

### File List
| File | Action | Description |
|------|--------|-------------|
| `apps/mobile/app/(tabs)/item-detail.tsx` | Modified | Complete rewrite with full functionality |
| `apps/mobile/app/(tabs)/wardrobe.tsx` | Modified | Added itemIds param for navigation |
