# Story 7.1: Resale Candidate Identification

## Status

**Implemented**

---

## Story

**As a** user,
**I want** to see which items are good candidates for resale,
**so that** I know what to consider selling.

---

## Acceptance Criteria

1. "Ready to Sell" section on Analytics dashboard
2. Algorithm identifies: items not worn in 90+ days, high CPW items
3. Items ranked by "resale potential" score
4. Quick filter in wardrobe: "Resale Candidates"
5. Nudge notification: "You have 3 items you haven't worn in 3 months"
6. CTA: "Create listing" button on candidate items

---

## Tasks / Subtasks

- [ ] **Task 1: Resale Service & Logic** (AC: 2, 3)
  - [ ] Create `vestiaire/apps/mobile/services/resaleService.ts`.
  - [ ] Implement `getResaleCandidates(userId: string): Promise<Item[]>`:
    - Determine "Not worn in 90d": `last_worn_at < NOW - 90 days`.
    - Determine "High CPW": `(purchase_price / wear_count) > X` (Define threshold, e.g., >£5).
    - Calculate `resale_score`:
      - Base: +50
      - Not worn > 180d: +20
      - High Original Price (>£100): +20
      - Brand is Known/Premium: +10 (Simple check vs predefined list or metadata)
  - [ ] Return sorted list descending by score.

- [ ] **Task 2: UI - Analytics Dashboard Integration** (AC: 1, 6)
  - [ ] Update `AnalyticsScreen` (Story 5.6).
  - [ ] Add `ResaleCandidatesCard` component.
  - [ ] Horizontal scroll of candidate items.
  - [ ] Each card has "Create Listing" button (Navigates to Create Listing flow - Story 7.2 placeholder).

- [ ] **Task 3: UI - Wardrobe Filter** (AC: 4)
  - [ ] Update `WardrobeScreen` filters.
  - [ ] Add "Resale Candidates" pill/option.
  - [ ] Uses `getResaleCandidates` or same logic to filter view.

- [ ] **Task 4: Notification Logic** (AC: 5)
  - [ ] Check for candidates periodically (e.g., on app open once per week).
  - [ ] If candidates > 0, schedule/trigger local notification: "You have X items you could sell!".
  - [ ] Store `last_resale_nudge` in `user_stats` or AsyncStorage to avoid spamming.

- [ ] **Task 5: Testing**
  - [ ] Unit Test `getResaleCandidates` logic (mock items with various `last_worn_at` dates).
  - [ ] Manual Test: Verify "Not Worn" items appear in dashboard.
  - [ ] Manual Test: Verify "Create Listing" button tap works (even if it just alerts for now).

---

## Dev Notes

### Architecture references
- **Resale Service**: New service to encapsulate resale logic.
- **Integration**: Tightly coupled with `items` and `wear_logs` data.

### Technical Decisions
- **Resale Score**: Simple heuristic for MVP. No external valuation API yet.
- **Nudge**: Client-side check on launch to avoid server cost.

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-07 | 1.0 | Initial story draft | Bob (SM) |
