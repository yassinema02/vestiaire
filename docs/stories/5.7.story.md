# Story 5.7: Wear Calendar View

## Status

**Draft**

---

## Story

**As a** user,  
**I want** to see a calendar of what I wore each day,  
**so that** I can review my outfit history.

---

## Acceptance Criteria

1. Monthly calendar view in Analytics section
2. Days with logged outfits show thumbnail/dot indicator
3. Tap day to see outfit worn that day
4. Multiple outfits per day supported
5. Navigate between months
6. Empty days show "No outfit logged"
7. Stats: "You logged 18 outfits this month"

---

## Tasks / Subtasks

- [ ] **Task 1: Create Wear Calendar Screen** (AC: 1, 5)
  - [ ] Create `app/(tabs)/wear-calendar.tsx` screen
  - [ ] Add navigation from Analytics screen
  - [ ] Monthly calendar grid layout (7 columns x 6 rows)
  - [ ] Month/year header with prev/next navigation
  - [ ] Register route in `_layout.tsx`

- [ ] **Task 2: Query Wear Logs by Month** (AC: 2)
  - [ ] Add `getWearLogsByMonth(year, month)` to wearLogService
  - [ ] Return wear logs grouped by date
  - [ ] Include item images for thumbnails
  - [ ] Cache results for performance

- [ ] **Task 3: Display Day Indicators** (AC: 2, 6)
  - [ ] Show dot indicator on days with wear logs
  - [ ] Optional: show item thumbnail on calendar cell
  - [ ] Gray out days with no logs
  - [ ] Highlight today's date

- [ ] **Task 4: Day Detail Modal/Sheet** (AC: 3, 4)
  - [ ] Tap day opens bottom sheet or modal
  - [ ] Display all outfits worn that day
  - [ ] Show item images in grid/row
  - [ ] Multiple outfits shown separately
  - [ ] "No outfit logged" message for empty days

- [ ] **Task 5: Add Monthly Stats** (AC: 7)
  - [ ] Calculate total logs for displayed month
  - [ ] Display: "You logged X outfits this month"
  - [ ] Show at bottom of calendar

- [ ] **Task 6: Testing**
  - [ ] Test month navigation
  - [ ] Test day tap and modal display
  - [ ] Test multiple outfits per day
  - [ ] Test empty month display

---

## Dev Notes

### Previous Story Dependencies
- Story 5.1: wear_logs table with dates âœ…
- Story 5.5: Analytics screen exists âœ…

### Calendar Query

```typescript
interface WearCalendarDay {
    date: string; // YYYY-MM-DD
    logs: WearLog[];
    itemImages: string[];
}

async function getWearLogsByMonth(
    year: number,
    month: number // 0-indexed
): Promise<WearCalendarDay[]> {
    const startDate = new Date(year, month, 1);
    const endDate = new Date(year, month + 1, 0); // Last day of month
    
    const { data } = await supabase
        .from('wear_logs')
        .select(`
            *,
            item:items(id, name, processed_image_url, image_url)
        `)
        .gte('worn_date', startDate.toISOString().split('T')[0])
        .lte('worn_date', endDate.toISOString().split('T')[0])
        .order('worn_date', { ascending: true });
    
    // Group by date
    return groupByDate(data);
}
```

### Calendar UI Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â—€  February 2026  â–¶               â”‚
â”œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¤
â”‚ S â”‚ M â”‚ T â”‚ W â”‚ T â”‚ F â”‚ S â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚ 1 â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ 2 â”‚ 3â—â”‚ 4 â”‚ 5â—â”‚ 6 â”‚ 7â—â”‚ 8 â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ 9 â”‚10â—â”‚11 â”‚12 â”‚13â—â”‚14 â”‚15 â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚16 â”‚17 â”‚18â—â”‚19 â”‚20â—â”‚21â—â”‚22 â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚23â—â”‚24 â”‚25 â”‚26â—â”‚27 â”‚28 â”‚   â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
â”‚ You logged 12 outfits this month   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â— = day with wear log
```

### Day Detail Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ February 5, 2026                   Xâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Outfit 1 (Casual)                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”               â”‚
â”‚ â”‚ ğŸ‘• â”‚ â”‚ ğŸ‘– â”‚ â”‚ ğŸ‘Ÿ â”‚               â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Outfit 2 (Work)                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                       â”‚
â”‚ â”‚ ğŸ‘” â”‚ â”‚ ğŸ‘– â”‚                       â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Calendar Libraries

Options for React Native calendar:
- `react-native-calendars` â€” full-featured, customizable
- Custom implementation with `FlatList` grid
- Simple grid with `View` components

Recommendation: Custom implementation for better control and lighter weight.

### Color Palette

| Element | Color | Hex |
|---------|-------|-----|
| Today highlight | Indigo | `#6366f1` |
| Day with logs | Green dot | `#22c55e` |
| Inactive day | Gray | `#d1d5db` |
| Selected day | Indigo bg | `#eef2ff` |

### File Locations

| File | Path |
|------|------|
| Calendar Screen | `apps/mobile/app/(tabs)/wear-calendar.tsx` |
| Wear Log Service | `apps/mobile/services/wearLogService.ts` |
| Day Detail Modal | `apps/mobile/components/features/WearDayModal.tsx` |

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-06 | 1.0 | Initial story draft | Bob (SM) |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.6

### Debug Log References
- TypeScript check: 0 errors in modified/created files (pre-existing errors in other files unrelated to this story)

### Completion Notes List
- Task 1: Created monthly calendar screen with custom grid layout (no external library)
- Task 2: Added `getWearLogsByMonth()` to wearLogService with date grouping
- Task 3: Day cells show green dot indicators for days with logs, indigo highlight for today
- Task 4: Day detail modal (bottom sheet) shows outfits grouped by outfit_id with item thumbnails
- Task 5: Monthly stats displayed at bottom: "You logged X outfits this month"
- Navigation: Calendar button added to Analytics dashboard, route registered as hidden tab

### File List

| File | Action | Description |
|------|--------|-------------|
| `apps/mobile/types/wearLog.ts` | Modified | Added `WearCalendarDay` interface |
| `apps/mobile/services/wearLogService.ts` | Modified | Added `getWearLogsByMonth()` method with date grouping |
| `apps/mobile/app/(tabs)/wear-calendar.tsx` | Created | Monthly calendar screen with navigation, grid, day indicators, stats |
| `apps/mobile/components/features/WearDayModal.tsx` | Created | Day detail bottom sheet modal with outfit grouping |
| `apps/mobile/app/(tabs)/_layout.tsx` | Modified | Registered `wear-calendar` as hidden route |
| `apps/mobile/app/(tabs)/analytics.tsx` | Modified | Added "Wear Calendar" navigation card with styles |

---

## QA Results
_(To be completed by QA Agent)_
