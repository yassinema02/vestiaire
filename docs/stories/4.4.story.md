# Story 4.4: Swipe-Based Outfit Review

## Status

**Done**

---

## Story

**As a** user,
**I want** to swipe through multiple outfit suggestions,
**so that** I can find one that suits my mood.

---

## Acceptance Criteria

1. AI generates 3-5 outfit options per request
2. Card stack UI: swipe right to save, left to dismiss
3. Swipe up to see outfit details (items breakdown)
4. Saved outfits added to "My Outfits" collection
5. Animation feedback on swipe actions
6. "No more suggestions" state with regenerate option
7. Generation counter in UI (X of 3 daily)

---

## Tasks / Subtasks

- [x] **Task 1: Create SwipeableOutfitCard component** (AC: 2, 5)
  - [x] Create `components/features/SwipeableOutfitCard.tsx`
  - [x] Implement swipe gesture detection using react-native-gesture-handler
  - [x] Add swipe right (save) animation with heart icon
  - [x] Add swipe left (dismiss) animation with X
  - [x] Add smooth card transition animations with reanimated

- [x] **Task 2: Create OutfitSwipeStack component** (AC: 1, 2, 6)
  - [x] Create `components/features/OutfitSwipeStack.tsx`
  - [x] Display stacked cards with perspective
  - [x] Handle card removal on swipe
  - [x] Show "All done!" state with saved count
  - [x] Add regenerate button at end of stack

- [x] **Task 3: Create outfit swipe screen** (AC: 1-6)
  - [x] Create `app/(tabs)/outfits/swipe.tsx`
  - [x] Integrate with useOutfitGeneration hook
  - [x] Handle swipe right to save outfit
  - [x] Detail modal on swipe up

- [x] **Task 4: Add swipe indicators** (AC: 2, 5)
  - [x] Show SAVE/SKIP labels during swipe
  - [x] Visual feedback based on swipe direction
  - [x] Action buttons below cards

- [x] **Task 5: Update Outfits tab navigation** (AC: 1-7)
  - [x] Add "Discover" button to trigger swipe mode
  - [x] Show saved outfits list with thumbnails
  - [x] AI badge for AI-generated outfits

---

## Dev Notes

### Previous Story Insights
[Source: Story 4.2, Story 4.3]

**useOutfitGeneration hook provides:**
- `suggestions` - Array of 3 outfit suggestions
- `isLoading`, `error` states
- `generate()` / `regenerate()` functions
- `saveSuggestion()` - Saves to My Outfits

**Existing OutfitCard can be reused** with modifications for swipe behavior.

### Dependencies

Need to install gesture handler if not already:
```bash
npx expo install react-native-gesture-handler react-native-reanimated
```

### Swipe Behavior

| Gesture | Action |
|---------|--------|
| Swipe Right (>100px) | Save to My Outfits |
| Swipe Left (>100px) | Dismiss |
| Swipe Up (>80px) | Show detail modal |
| Tap | Expand card |

### File Locations

```
apps/mobile/
├── components/features/
│   ├── SwipeableOutfitCard.tsx   # NEW: Swipeable card wrapper
│   └── OutfitSwipeStack.tsx      # NEW: Card stack manager
├── app/(tabs)/outfits/
│   └── swipe.tsx                 # NEW: Swipe discovery screen
```

---

## Testing

### Test Cases

**Gestures:**
- Swipe right saves outfit with animation
- Swipe left dismisses card
- Swipe up opens details
- Velocity affects animation speed

**Stack:**
- Cards stack visually with perspective
- Next card visible behind current
- Empty state after all cards swiped
- Regenerate creates new stack

**Save:**
- Saved outfit appears in My Outfits
- Toast/feedback confirms save

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-01 | 1.0 | Initial story draft | Bob (SM) |

---

## Dev Agent Record

### Agent Model Used
Claude (Anthropic) via Antigravity

### Debug Log References
Installed react-native-gesture-handler and react-native-reanimated
TypeScript check passed (only pre-existing error)

### Completion Notes List
1. Installed `react-native-gesture-handler` and `react-native-reanimated` dependencies
2. Created `SwipeableOutfitCard.tsx` with pan gesture, rotation, and animated indicators
3. Created `OutfitSwipeStack.tsx` with card stacking, progress bar, and action buttons
4. Created `outfits/swipe.tsx` screen with GestureHandlerRootView and detail modal
5. Updated `outfits.tsx` with "Discover" button and saved outfits list
6. Swipe right saves, swipe left dismisses, swipe up shows details
7. "All done" state shows saved count and regenerate option

### File List

| File | Action | Description |
|------|--------|-------------|
| `components/features/SwipeableOutfitCard.tsx` | NEW | Gesture-enabled card |
| `components/features/OutfitSwipeStack.tsx` | NEW | Card stack manager |
| `app/(tabs)/outfits/swipe.tsx` | NEW | Swipe discovery screen |
| `app/(tabs)/outfits.tsx` | MODIFIED | Added Discover + saved list |
